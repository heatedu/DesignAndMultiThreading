================================================================================
               CAR RENTAL SYSTEM - EXECUTION FLOW
                    Quick Visual Reference
================================================================================

COMPLETE USER JOURNEY FROM START TO FINISH
===========================================

┌─────────────────────────────────────────────────────────────────────────┐
│                         PROGRAM START                                   │
│                         main.cpp:1                                      │
└────────────────────────────────┬────────────────────────────────────────┘
                                 │
                                 ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 1: SINGLETON PATTERN                     ║
        ║  Get CarRentalSystem instance                  ║
        ╚════════════════════════════════════════════════╝
                                 │
                    ┌────────────┴────────────┐
                    │ getInstance() called    │
                    │ First time?             │
                    └────────────┬────────────┘
                                 │
                        ┌────────┴────────┐
                        │                 │
                       YES               NO
                        │                 │
             ┌──────────▼─────────┐       │
             │ Lock mutex         │       │
             │ Create new instance│       │
             │ Unlock mutex       │       │
             └──────────┬─────────┘       │
                        │                 │
                        └────────┬────────┘
                                 │
                                 ▼
                      [Instance: 0x...710]
                                 │
                                 ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 2: SETUP STORES                          ║
        ║  Create Mumbai & Delhi stores                  ║
        ╚════════════════════════════════════════════════╝
                                 │
                    ┌────────────┴────────────┐
                    │ Store("S1", "Mumbai")   │
                    │ Store("S2", "Delhi")    │
                    └────────────┬────────────┘
                                 │
                    ┌────────────▼────────────┐
                    │ addStore(mumbaiStore)   │
                    │ addStore(delhiStore)    │
                    └────────────┬────────────┘
                                 │
                                 ▼
                stores["Mumbai"] = S1
                stores["Delhi"] = S2
                                 │
                                 ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 3: FACTORY PATTERN                       ║
        ║  Create vehicles using VehicleFactory          ║
        ╚════════════════════════════════════════════════╝
                                 │
            ┌────────────────────┼────────────────────┐
            │                    │                    │
            ▼                    ▼                    ▼
    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐
    │ ECONOMY      │    │ LUXURY       │    │ SUV          │
    │ VehicleType  │    │ VehicleType  │    │ VehicleType  │
    └──────┬───────┘    └──────┬───────┘    └──────┬───────┘
           │                   │                    │
           ▼                   ▼                    ▼
    Factory creates:    Factory creates:    Factory creates:
    EconomyVehicle      LuxuryVehicle       SUVVehicle
           │                   │                    │
           └───────────────────┴────────────────────┘
                               │
                               ▼
                    addVehicle() to stores
                               │
                               ▼
        inventory["MH01AB1234"] = swift
        inventory["MH01CD1234"] = merc
        inventory["MH01EF1234"] = fortuner
                               │
                               ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 4: REGISTER USERS                        ║
        ╚════════════════════════════════════════════════╝
                               │
                ┌──────────────┴──────────────┐
                │ User("U001", "Rahul", ...)  │
                │ addUser(user1)              │
                └──────────────┬──────────────┘
                               │
                               ▼
                users["U001"] = user1
                               │
                               ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 5: SEARCH VEHICLES                       ║
        ╚════════════════════════════════════════════════╝
                               │
        ┌──────────────────────┴──────────────────────┐
        │ searchVehicles("Mumbai", ECONOMY, dates)    │
        └──────────────────────┬──────────────────────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
              ▼                ▼                ▼
        Find store      Get vehicles    Check conflicts
              │                │                │
              ▼                ▼                ▼
        stores["Mumbai"] → getAvailableVehicles(ECONOMY)
                               │
                    ┌──────────┴──────────┐
                    │ For each vehicle:   │
                    │ - Type = ECONOMY?   │
                    │ - Status = AVAILABLE│
                    │ - No conflicts?     │
                    └──────────┬──────────┘
                               │
                               ▼
                    [Swift, i10] returned
                               │
                               ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 6: CREATE RESERVATION (STRATEGY PATTERN) ║
        ╚════════════════════════════════════════════════╝
                               │
        ┌──────────────────────┴──────────────────────────┐
        │ 1. User selects payment method                  │
        └──────────────────────┬──────────────────────────┘
                               │
            ┌──────────────────┼──────────────────┐
            │                  │                  │
            ▼                  ▼                  ▼
    CreditCardPayment   UPIPayment      CashPayment
    (Strategy 1)        (Strategy 2)    (Strategy 3)
            │                  │                  │
            └──────────────────┴──────────────────┘
                               │
                               ▼
        ┌─────────────────────────────────────────────────┐
        │ 2. createReservation(userId, vehicleReg,        │
        │                      start, end, STRATEGY)      │
        └──────────────────────┬─────────────────────────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
              ▼                ▼                ▼
        Check conflict   Find vehicle   Calculate price
              │                │                │
              ▼                ▼                ▼
        No overlap?    vehicle->        days * rate
                       getRegNumber()          │
              │                │                │
              └────────────────┴────────────────┘
                               │
                               ▼
        ┌──────────────────────────────────────────────┐
        │ Create Reservation object                    │
        │ - ID: RES1                                   │
        │ - State: PENDING (initial state)             │
        │ - Cost: Rs. 150                              │
        └──────────────────────┬───────────────────────┘
                               │
                               ▼
        ┌──────────────────────────────────────────────┐
        │ Create Payment object with strategy          │
        │ - ID: PAY1                                   │
        │ - Strategy: CreditCardPayment                │
        └──────────────────────┬───────────────────────┘
                               │
                               ▼
               reservation->setPayment(payment)
                               │
                               ▼
              reservations["RES1"] = reservation
                               │
                               ▼
           vehicle->setStatus(RESERVED)
                               │
                               ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 7: PROCESS PAYMENT (STRATEGY IN ACTION)  ║
        ╚════════════════════════════════════════════════╝
                               │
        ┌──────────────────────┴──────────────────────┐
        │ processReservationPayment("RES1")           │
        └──────────────────────┬──────────────────────┘
                               │
                               ▼
        ┌──────────────────────────────────────────────┐
        │ payment->process(amount)                     │
        └──────────────────────┬──────────────────────┘
                               │
                               ▼
        ┌──────────────────────────────────────────────┐
        │ strategy->processPayment(amount, details)    │
        │ (Calls CreditCardPayment::processPayment)    │
        └──────────────────────┬──────────────────────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
              ▼                ▼                ▼
        Validate card   Process txn     Generate ID
              │                │                │
              ▼                ▼                ▼
        Card OK?        Status:         TX: CC-RES1-1689
                        PROCESSING              │
              │                │                │
              └────────────────┴────────────────┘
                               │
                               ▼
                    Status: COMPLETED
                               │
                               ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 8: STATE TRANSITION (STATE PATTERN)      ║
        ╚════════════════════════════════════════════════╝
                               │
                               ▼
        ┌─────────────────────────────────────────┐
        │ reservation->confirm()                  │
        └──────────────────┬──────────────────────┘
                           │
              ┌────────────▼────────────┐
              │ Check: status==PENDING? │
              │ YES → status=CONFIRMED  │
              └────────────┬────────────┘
                           │
                           ▼
            STATE: PENDING ══► CONFIRMED
                           │
                           ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 9: START RENTAL (STATE TRANSITION)       ║
        ╚════════════════════════════════════════════════╝
                           │
        ┌──────────────────┴────────────────────┐
        │ startRental("RES1")                   │
        └──────────────────┬────────────────────┘
                           │
              ┌────────────▼────────────┐
              │ Check: CONFIRMED?       │
              │ YES → IN_PROGRESS       │
              │ Record pickupTime       │
              └────────────┬────────────┘
                           │
                           ▼
         STATE: CONFIRMED ══► IN_PROGRESS
                           │
                           ▼
            vehicle->setStatus(RENTED)
                           │
                           ▼
        ╔════════════════════════════════════════════════╗
        ║  STEP 10: COMPLETE RENTAL (STATE TRANSITION)   ║
        ╚════════════════════════════════════════════════╝
                           │
        ┌──────────────────┴────────────────────┐
        │ completeRental("RES1")                │
        └──────────────────┬────────────────────┘
                           │
              ┌────────────▼────────────┐
              │ Check: IN_PROGRESS?     │
              │ YES → COMPLETED         │
              │ Record returnTime       │
              └────────────┬────────────┘
                           │
                           ▼
        STATE: IN_PROGRESS ══► COMPLETED
                           │
                           ▼
           vehicle->setStatus(AVAILABLE)
                           │
                           ▼
        ╔════════════════════════════════════════════════╗
        ║  END - RENTAL CYCLE COMPLETE                   ║
        ╚════════════════════════════════════════════════╝


COMPLETE STATE DIAGRAM FOR RESERVATION
========================================

        ┌─────────────────┐
        │    PENDING      │  ← Initial state after creation
        └────────┬────────┘
                 │
                 │ processPayment() succeeds
                 │
                 ▼
        ┌─────────────────┐
        │   CONFIRMED     │  ← After successful payment
        └────┬───────┬────┘
             │       │
             │       │ No show timeout
             │       │
             │       ▼
             │  ┌─────────────────┐
             │  │    NO_SHOW      │
             │  └─────────────────┘
             │
             │ cancel() called
             │
             ▼
        ┌─────────────────┐
        │   CANCELLED     │
        └─────────────────┘

        From CONFIRMED:
             │
             │ startRental() called (pickup)
             │
             ▼
        ┌─────────────────┐
        │  IN_PROGRESS    │  ← Vehicle picked up
        └────────┬────────┘
                 │
                 │ complete() called (return)
                 │
                 ▼
        ┌─────────────────┐
        │   COMPLETED     │  ← Rental finished
        └─────────────────┘


CONFLICT PREVENTION FLOW
=========================

Request: Book vehicle MH01AB1234
Dates: Day 3 to Day 6

    ┌──────────────────────────────────────┐
    │ createReservation() called           │
    └─────────────────┬────────────────────┘
                      │
                      ▼
    ┌──────────────────────────────────────┐
    │ hasConflict(vehicle, dates)?         │
    └─────────────────┬────────────────────┘
                      │
          ┌───────────┴───────────┐
          │                       │
          ▼                       ▼
    ┌─────────────┐         ┌─────────────┐
    │ NO CONFLICT │         │ CONFLICT!   │
    └──────┬──────┘         └──────┬──────┘
           │                       │
           │                       │
           ▼                       ▼
    Create reservation      Return nullptr
           │                       │
           │                       │
           ▼                       ▼
    SUCCESS!                  REJECTED!


    Conflict Check Details:
    ┌────────────────────────────────────────────┐
    │ Existing: Day 2 ─────────► Day 5          │
    │ New:           Day 3 ────────► Day 6      │
    │                                            │
    │ Overlap? YES (Day 3-5 overlaps)           │
    │ Result: CONFLICT DETECTED                 │
    └────────────────────────────────────────────┘


PAYMENT STRATEGY SELECTION
===========================

                  User chooses payment method
                            │
       ┌────────────────────┼────────────────────┐
       │                    │                    │
       ▼                    ▼                    ▼
┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│ Credit Card  │    │     UPI      │    │     Cash     │
│   Strategy   │    │   Strategy   │    │   Strategy   │
└──────┬───────┘    └──────┬───────┘    └──────┬───────┘
       │                    │                    │
       │ Validate           │ Validate           │ Always
       │ card details       │ UPI ID             │ valid
       │                    │                    │
       ▼                    ▼                    ▼
┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│ Process via  │    │ Process via  │    │ Manual       │
│ card gateway │    │ UPI app      │    │ receipt      │
└──────┬───────┘    └──────┬───────┘    └──────┬───────┘
       │                    │                    │
       └────────────────────┴────────────────────┘
                            │
                            ▼
                  Transaction ID generated
                            │
                            ▼
                   Payment COMPLETED


FACTORY PATTERN IN ACTION
==========================

    User needs: SUV vehicle

                createVehicle(SUV, ...)
                            │
                            ▼
                  ┌─────────────────────┐
                  │  VehicleFactory     │
                  └──────────┬──────────┘
                             │
                   switch(VehicleType)
                             │
              ┌──────────────┼──────────────┐
              │              │              │
         case ECONOMY   case LUXURY    case SUV
              │              │              │
              ▼              ▼              ▼
      EconomyVehicle   LuxuryVehicle   SUVVehicle
          created          created       created
              │              │              │
              └──────────────┴──────────────┘
                             │
                             ▼
                  return as Vehicle*
                             │
                             ▼
              Polymorphic usage enabled!


METHOD CALL SEQUENCE (SIMPLIFIED)
==================================

1.  main()
2.  ├─► CarRentalSystem::getInstance()  ← SINGLETON
3.  ├─► VehicleFactory::createVehicle() ← FACTORY
4.  ├─► Store::addVehicle()
5.  ├─► User()
6.  ├─► CarRentalSystem::searchVehicles()
7.  │   └─► hasConflict()  ← Checks existing reservations
8.  ├─► CarRentalSystem::createReservation()
9.  │   ├─► Reservation()  ← State: PENDING
10. │   └─► Payment(strategy)  ← STRATEGY attached
11. ├─► processReservationPayment()
12. │   ├─► Payment::process()
13. │   │   └─► CreditCardPayment::processPayment()  ← STRATEGY
14. │   └─► Reservation::confirm()  ← STATE: PENDING→CONFIRMED
15. ├─► startRental()
16. │   └─► Reservation::startRental()  ← STATE: CONFIRMED→IN_PROGRESS
17. ├─► completeRental()
18. │   └─► Reservation::complete()  ← STATE: IN_PROGRESS→COMPLETED
19. └─► return 0


DESIGN PATTERNS INTEGRATION
============================

┌─────────────────────────────────────────────────────────────┐
│                         Request                             │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
                    ┌──────────────────┐
                    │  SINGLETON       │  One system instance
                    └─────────┬────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  FACTORY         │  Create vehicles
                    └─────────┬────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  ENUMS           │  Type-safe states
                    └─────────┬────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  STRATEGY        │  Payment method
                    └─────────┬────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  STATE           │  Lifecycle management
                    └─────────┬────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  Response        │
                    └──────────────────┘


ALL PATTERNS WORKING TOGETHER SEAMLESSLY!

================================================================================

